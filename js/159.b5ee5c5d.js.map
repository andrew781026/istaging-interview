{"version":3,"file":"js/159.b5ee5c5d.js","mappings":"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","sources":["webpack://front/./src/views/ListView.vue","webpack://front/./src/components/Card.vue?a708","webpack://front/./src/components/LazyImage.vue?c346","webpack://front/./src/components/LazyImage.vue?e562","webpack://front/./src/components/LazyImage.vue","webpack://front/./src/components/Card.vue?9d3e","webpack://front/./src/components/Card.vue","webpack://front/./src/views/ListView.vue?c025"],"sourcesContent":["<template>\n  <div class=\"list\">\n    <div class=\"book-list\">\n      <Card v-for=\"book in bookList\" :key=\"book.isbn\" :book=\"book\" @click=\"viewDetail(book)\"></Card>\n    </div>\n    <div class=\"load-more\" ref=\"loadMore\" v-show=\"canLoadMore\">\n      <PrimaryButton type=\"primary\" @click=\"getMoreBooks\">LOAD MORE</PrimaryButton>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {defineComponent} from 'vue'\nimport Card from '@/components/Card.vue'\nimport PrimaryButton from '@/components/PrimaryButton.vue'\nimport {page, bookList, canLoadMore, setSingleBook, observer, loadMore, useBook, getMoreBooks} from './useBook'\nimport {useRouterCustom} from './useMyRoute'\n\nexport default defineComponent({\n  name: 'ListView',\n  setup() {\n    useBook()\n    const {toDetailPage} = useRouterCustom()\n\n    const viewDetail = book => {\n      setSingleBook(book)\n      // go to detail page\n      const id = book['@id'].replace('/books/', '')\n      toDetailPage(id)\n    }\n\n    return {observer, canLoadMore, loadMore, bookList, page, getMoreBooks, viewDetail}\n  },\n  components: {\n    Card,\n    PrimaryButton\n  }\n})\n</script>\n\n<style scoped>\n.book-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 30px;\n  padding: 30px;\n  justify-content: center;\n}\n\n.load-more {\n  display: flex;\n  justify-content: center;\n  margin-bottom: 30px;\n}\n</style>\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-46b28748\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"card\" }\nconst _hoisted_2 = { class: \"info\" }\nconst _hoisted_3 = [\"title\"]\nconst _hoisted_4 = [\"title\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_LazyImage = _resolveComponent(\"LazyImage\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(_component_LazyImage, {\n      isbn: _ctx.book.isbn\n    }, null, 8, [\"isbn\"]),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"h3\", {\n        class: \"title\",\n        title: _ctx.book.title\n      }, _toDisplayString(_ctx.book.title), 9, _hoisted_3),\n      _createElementVNode(\"h4\", {\n        class: \"author\",\n        title: _ctx.book.author\n      }, _toDisplayString(_ctx.book.author), 9, _hoisted_4)\n    ])\n  ]))\n}","import { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"data-src\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"img\", {\n    ref: \"imageRef\",\n    src: \"https://fakeimg.pl/800x600/\",\n    \"data-src\": `https://picsum.photos/800/600/?random=${ $props.isbn }`,\n    alt: \"圖片\"\n  }, null, 8, _hoisted_1))\n}","\nimport {onBeforeUnmount, onMounted, Ref, ref} from 'vue'\n\nconst imgObserver = new IntersectionObserver(entries => {\n  entries.forEach(entry => {\n    if (entry.target instanceof HTMLImageElement) {\n      const isIntersecting = entry.isIntersecting\n      const dataSrc = entry.target.dataset.src\n      const isReal = entry.target.dataset.isReal\n      const needUpdateSrc = isIntersecting && dataSrc && !isReal\n      if (needUpdateSrc) {\n        entry.target.src = dataSrc\n        entry.target.dataset.isReal = 'true'\n      }\n    }\n  })\n})\n\nconst useImage = (imageRef: Ref<HTMLImageElement>) => {\n  onMounted(() => {\n    // 開始觀察\n    imgObserver.observe(imageRef.value)\n  })\n\n  onBeforeUnmount(() => {\n    // 停止觀察\n    imgObserver.unobserve(imageRef.value)\n  })\n  return imgObserver\n}\n\nexport default {\n  name: 'LazyImage',\n  props: {\n    isbn: String\n  },\n  setup() {\n    const imageRef = ref(new Image())\n\n    useImage(imageRef)\n    return {imageRef}\n  }\n}\n","import { render } from \"./LazyImage.vue?vue&type=template&id=14a723d7&ts=true\"\nimport script from \"./LazyImage.vue?vue&type=script&lang=ts\"\nexport * from \"./LazyImage.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/runner/work/istaging-interview/istaging-interview/front/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","\nimport {defineComponent} from 'vue'\nimport LazyImage from '@/components/LazyImage.vue'\n\nexport default defineComponent({\n  name: 'PureCard',\n  props: {\n    book: Object\n  },\n  components: {\n    LazyImage\n  }\n})\n","import { render } from \"./Card.vue?vue&type=template&id=46b28748&scoped=true&ts=true\"\nimport script from \"./Card.vue?vue&type=script&lang=ts\"\nexport * from \"./Card.vue?vue&type=script&lang=ts\"\n\nimport \"./Card.vue?vue&type=style&index=0&id=46b28748&scoped=true&lang=scss\"\n\nimport exportComponent from \"/home/runner/work/istaging-interview/istaging-interview/front/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-46b28748\"]])\n\nexport default __exports__","import { render } from \"./ListView.vue?vue&type=template&id=2afb4d8e&scoped=true\"\nimport script from \"./ListView.vue?vue&type=script&lang=js\"\nexport * from \"./ListView.vue?vue&type=script&lang=js\"\n\nimport \"./ListView.vue?vue&type=style&index=0&id=2afb4d8e&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/runner/work/istaging-interview/istaging-interview/front/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2afb4d8e\"]])\n\nexport default __exports__"],"names":["class","ref","_createElementBlock","_createElementVNode","_Fragment","_renderList","_ctx","book","_createBlock","_component_Card","key","isbn","onClick","_createVNode","_component_PrimaryButton","type","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","render","_cache","$props","$setup","$data","$options","_component_LazyImage","_resolveComponent","_openBlock","title","_toDisplayString","author","src","alt","imgObserver","IntersectionObserver","entries","forEach","entry","target","HTMLImageElement","isIntersecting","dataSrc","dataset","isReal","needUpdateSrc","useImage","imageRef","onMounted","observe","value","onBeforeUnmount","unobserve","name","props","String","setup","Image","__exports__","defineComponent","Object","components","LazyImage","useBook","toDetailPage","useRouterCustom","viewDetail","setSingleBook","id","replace","observer","canLoadMore","loadMore","bookList","page","getMoreBooks","Card","PrimaryButton"],"sourceRoot":""}